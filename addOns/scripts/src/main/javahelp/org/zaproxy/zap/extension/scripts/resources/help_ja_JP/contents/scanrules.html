<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>スクリプト – スキャンルール</title>
</head>
<body>
<h1>スクリプト – スキャンルール</h1>

<code>getMetadata</code>関数を実装したアクティブスクリプトとパッシブスクリプトは、ZAPでは正式なスキャンルールとして扱われます。

スクリプト内でこの関数を実装する例は次のとおりです:

<pre><code>
function getMetadata() {
	return ScanRuleMetadata.fromYaml(`
id: 12345
name: Active Vulnerability Title
description: Full description
solution: The solution
references:
  - Reference 1
  - Reference 2
category: INJECTION  # info_gather, browser, server, misc, injection
risk: INFO  # info, low, medium, high
confidence: LOW  # false_positive, low, medium, high, user_confirmed
cweId: 0
wascId: 0
alertTags:
  name1: value1
  name2: value2
otherInfo: Any other Info
status: alpha
alertRefOverrides:
  12345-1:
    name: Alert Reference 1

`);
}
</code></pre>

<p>
metadata関数はスクリプトの保存時に評価され、メタデータが有効であればスキャンルールとして公開されます。

<p>
<code>category</code>フィールドは、アクティブスキャンスクリプトでのみ使用されます。

<p>
<code>alertRefOverrides</code>フィールドを使用すると、各アラート参照の特定のフィールドを上書きできます。
<code>id</code>、<code>category</code>、<code>status</code>を除く、すべての最上位フィールドを上書きできます。
アラート参照は、1つのスキャンルールが複数のタイプのアラートを発生させる場合に、各アラートタイプを一意に識別するために使用されます。
通常、アラート参照はスキャンルールIDに連番の数字をサフィックスとして付加した形式（例: <code>12345-1</code>、<code>12345-2</code>など）になります。
特定のアラート参照のメタデータを使用するアラートを発生させるには、<code>newAlert()</code>の引数としてアラート参照を渡します。

<p>
メタデータ内で定義されていないフィールドは無視されます (例: <code>author: your name</code>)。

</body>
</html>
