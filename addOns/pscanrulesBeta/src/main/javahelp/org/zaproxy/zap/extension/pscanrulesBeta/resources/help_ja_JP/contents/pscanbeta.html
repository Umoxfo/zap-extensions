<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>
パッシブスキャンルール - Beta
</title>
</head>
<body>
<h1>パッシブスキャンルール - Beta</h1>

<h2>全般設定</h2>

<h3>信頼済みドメイン</h3>
オプションの「ルール設定」パネルから <code>rules.domains.trusted</code> パラメーターを使用して、カンマ区切りのURL正規表現パターンリストを指定できます。
これらのパターンに一致するリンクURLは信頼済みドメインと見なされ、アラートの対象外となります。
 以下のルールが <b>信頼済みドメイン</b> 機能をサポートしています：
<ul>
 <li>サブリソース整合性属性の欠落</li>
</ul>

<hr>

以下のベータステータスのパッシブスキャンルールがこのアドオンに含まれています：

<h2 id="id-10049">コンテンツのキャッシュ適性</h2>
このスキャンルールは、HTTPトラフィック内の Cache-Control ヘッダーと Pragma ヘッダーを分析し、RFC7234に基づいてリクエストのキャッシュ適性を報告します。
<p>
生成されるアラート：
<ul>
 <li><b>保存不可能なコンテンツ</b></li>
 <li><b>保存可能だがキャッシュ不可なコンテンツ</b></li>
 <li><b>保存可能でキャッシュ可能なコンテンツ</b></li>
</ul>
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrulesBeta/src/main/java/org/zaproxy/zap/extension/pscanrulesBeta/CacheableScanRule.java">CacheableScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10049/">10049</a>

<h2 id="id-10110">危険なJavaScript関数</h2>
このスキャンルールは、サイトのレスポンスに存在する危険なJavaScript関数をチェックします。<br>
<strong>注意:</strong> カスタムペイロードアドオンがインストールされている場合、カスタムペイロードのオプションパネルで独自の関数名 (ペイロード) を追加できます。
これらもパッシブスキャン実行時にレスポンス内で検索されます。 ペイロードの数が多いほど、パッシブスキャンに必要な時間が長くなることに注意してください。
<br>
このルールのカスタムペイロードカテゴリ: <code>JS-Function</code>
<br>
<strong>注:</strong> &dollar; は文字列/ペイロードの先頭から削除され、パターン組み立て時にオプションで含められます。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrulesBeta/src/main/java/org/zaproxy/zap/extension/pscanrulesBeta/JsFunctionScanRule.java">JsFunctionScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10110/">10110</a>

<h2 id="id-10009">ページ内バナー情報漏洩</h2>
レスポンスボディのコンテンツを分析し、(レスポンスがエラーステータスコードの場合に) Webサーバーまたはアプリケーションサーバーのバナーの存在を検出します。<br>
しきい値が Low の場合、ステータス 200 - OK のレスポンスも分析されます。<br>
このようなバナーの存在は、既知の脆弱性に対するより標的を絞った攻撃を容易にする可能性があります。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrulesBeta/src/main/java/org/zaproxy/zap/extension/pscanrulesBeta/InPageBannerInfoLeakScanRule.java">InPageBannerInfoLeakScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10009/">10009</a>

<h2 id="id-90002">Javaシリアライゼーションオブジェクト</h2>
Javaシリアライゼーションオブジェクト (JSO) は、Javaアプリケーション間でオブジェクトを保存および交換する方法です。<br>
JSOには複数のセキュリティ上の問題があります。 機密データがバイトストリームに漏洩する可能性があり、攻撃者はデータを改変してJSOを悪用し、サーバー上でリモートコード実行を行うこともできます。<br>
JSOはJavaプログラムで使用すべきではありません。 シリアライズされたデータには厳格な制御が必要です。<br>
JSOは、OWASP Top 10の「A8:2017-安全でないデシリアライゼーション」に関連する脆弱性の一種です。
<p>
最新のコード: <br>JsoScanRule.java</a><1>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/90002/">90002</a>

<h2 id="id-10063">Permissions-Policy ヘッダー未設定</h2>
このルールは、(HTMLおよびJavaScriptレスポンスの) HTTPレスポンスヘッダーに「Permissions-Policy」ヘッダーが含まれているかをチェックし、 見つからない場合にアラートを発生させます。 また、非推奨のヘッダー「Feature-Policy」が見つかった場合もアラートを発生させます。<br>
リダイレクトは、しきい値が Low の場合を除いて無視されます。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrulesBeta/src/main/java/org/zaproxy/zap/extension/pscanrulesBeta/PermissionsPolicyScanRule.java">PermissionsPolicyScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10063/">10063</a>

<h2 id="id-90004">サイト分離スキャンルール</h2>
Spectreは、攻撃者がメモリからデータを読み取ることを可能にするサイドチャネル攻撃です。 対策の1つは、機密データが メモリに入るのを防ぎ、信頼されたドキュメントと信頼されていないドキュメントを 異なるブラウジングコンテキストで分離することです。 これを実現するために3つのヘッダーが定義されています：
<ul>
 <li>Cross-Origin-Resource-Policy</li>
 <li>Cross-Origin-Embedder-Policy</li>
 <li>Cross-Origin-Opener-Policy</li>
</ul>
Cross-Origin-Embedder-Policy (COEP) ヘッダーは <q>ドキュメントが読み込まれることを明示的に許可していない すべての非同一オリジンリソースを、ドキュメントが読み込むことを防ぎます。</q> (出典:
<a href="https://docs.google.com/document/d/1zDlfvfTJ_9e8Jdc8ehuV4zMEu9ySMCiTGMS9y0GU92k/edit">COOP and COEP explained</a>).
<blockquote cite="https://resourcepolicy.fyi/">
 Cross-Origin-Resource-Policy (CORP) ヘッダーを使用すると、 リソースを含めることが許可されるオリジンのセットを制御できます。 これは、Spectre のような攻撃に対する堅牢な防御であり、 ブラウザが攻撃者のプロセスに入る前に特定のレスポンスをブロックすることを可能にします。
</blockquote>
例えば、攻撃者のサイトは、内部コンテンツへの src 属性を持つ image タグを含めることができます。 ブラウザはデータを読み込みます。 サイドチャネル攻撃により、攻撃者はそれを読み取ることができます。

 Cross-Origin-Opener-Policy (COOP) ヘッダーは、ブラウザに複数のブラウジングコンテキストを作成させ、 信頼されたドキュメントと信頼されていないドキュメントを分離します。

サイト分離は、ブラウザが独立して管理するメカニズムである Cross-Origin-Resource-Blocking と補完関係にあります。

<p>
 生成されるアラート：
<ul>
 <li><b>Cross-Origin-Resource-Policy ヘッダーの欠落または無効</b></li>
 <li><b>Cross-Origin-Embedder-Policy ヘッダーの欠落または無効</b></li>
 <li><b>Cross-Origin-Opener-Policy ヘッダーの欠落または無効</b></li>
</ul>
<p>
 最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrulesBeta/src/main/java/org/zaproxy/zap/extension/pscanrulesBeta/SiteIsolationScanRule.java">SiteIsolationScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/90004/">90004</a>

<h2 id="id-10026">サーブレットパラメーター汚染</h2>
action 要素の指定に失敗したHTMLフォームをレスポンスコンテンツ内で検索します。 Java Servlet仕様のバージョン3では、 クエリ文字列とPOSTデータ要素の集約が求められており、これによりユーザー制御データの意図しない処理が発生する可能性があります。 これは他のフレームワークやテクノロジーにも影響を与える可能性があります。
<strong>注:</strong> このスキャンルールは、しきい値が LOW かつ Tech JSP/Servlet が適用可能なコンテキストURL内のレスポンスのみを分析します。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrulesBeta/src/main/java/org/zaproxy/zap/extension/pscanrulesBeta/ServletParameterPollutionScanRule.java">ServletParameterPollutionScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10026/">10026</a>

<h2 id="id-10099">ソースコードの露見</h2>
アプリケーションのソースコードがWebサーバーによって露見しました。<br>
注意: CSS、JavaScript、画像、フォントファイル、およびISO制御文字を含むレスポンス (バイナリファイルの可能性が高いもの) は無視されます。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrulesBeta/src/main/java/org/zaproxy/zap/extension/pscanrulesBeta/SourceCodeDisclosureScanRule.java">SourceCodeDisclosureScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/10099/">10099</a>

<h2 id="id-90003">サブリソース整合性属性の欠落</h2>
このルールは、外部リソース (例: CDN) から提供される script 要素または link 要素に integrity 属性が欠落しているかをチェックします。<br>
これは、CDNが侵害され、コンテンツが悪意のあるコンテンツに置き換えられた場合の攻撃を軽減するのに役立ちます。<br>
注: サイトツリー内のスクリプトに解決できる場合、推奨される整合性ハッシュ値が関連するアラートの「その他の情報」詳細に表示されます。
<p>
このルールは<b>信頼済みドメイン</b>をサポートしています。詳細については「全般設定」を確認してください。
<p>
最新のコード: <a href="https://github.com/zaproxy/zap-extensions/blob/main/addOns/pscanrulesBeta/src/main/java/org/zaproxy/zap/extension/pscanrulesBeta/SubResourceIntegrityAttributeScanRule.java">SubResourceIntegrityAttributeScanRule.java</a><br>
アラートID: <a href="https://www.zaproxy.org/docs/alerts/90003/">90003</a>

</body>
</html>
