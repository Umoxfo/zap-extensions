<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>
Replacer
</title>
</head>
<body>
<h1>Replacer（置換機能）</h1>
Replacerは、リクエストおよびレスポンス内の文字列を簡単に置き換える機能です。
<p>
オプションメニューからアクセスでき、デフォルトでは「&lt;ctrl&gt; R」ホットキーで素早く開くことができます。
<p>
また、<a href="automation.html">自動化フレームワーク</a>に対応しています。
<p>
置換機能のオプションパネルでは、必要な数の置換ルールを定義できます。<br>
各ルールは以下のフィールドで定義されます：
<h3>説明</h3>
ルールを識別できるようにする説明。

<h3>URL</h3>
メッセージのURLと照合する正規表現。空の場合、ルールはすべてのメッセージに適用されます。<br>
例えば、認証資格情報を提供する際に、ルールを特定のドメインに制限できます。

<h3>マッチタイプ</h3>
次のいずれかを指定します：

<h4>リクエストヘッダー (未設定時は追加)</h4>
マッチ文字列はヘッダー名として扱われます。 
ヘッダーが存在する場合、その値が置換テキストで置き換えられます。 
置換テキストが空の場合、ヘッダーが削除されます (存在する場合)。
ヘッダーが存在せず置換テキストが空でない場合、ヘッダーが追加されます。

<h4>リクエストヘッダー文字列</h4>
マッチ文字列は文字列または正規表現として扱われます。
リクエストヘッダー内に存在する場合、置換テキストで置き換えられます。

<h5>Host ヘッダー</h5>
リクエストヘッダーとリクエストヘッダー文字列の両方のマッチタイプで、元のリクエストターゲットにメッセージを送信しながら、Host ヘッダーを変更/削除できます。

<h4>リクエストボディ文字列</h4>
この場合、「マッチ文字列」は文字列または正規表現として扱われます。
リクエストボディ内に存在する場合、置換テキストで置き換えられます。

<h4>レスポンスヘッダー (存在しない場合は追加)</h4>
この場合、「マッチ文字列」はヘッダー名として扱われます。 
ヘッダーが存在する場合、その値は置換テキストで置き換えられます。 
置換テキストが空の場合、ヘッダーが削除されます (存在する場合)。
ヘッダーが存在せず置換テキストが空でない場合、ヘッダーが追加されます。

<h4>レスポンスヘッダー文字列</h4>
この場合、「マッチ文字列」は文字列または正規表現として扱われます。
レスポンスヘッダー内に存在する場合、置換テキストで置き換えられます。

<h4>レスポンスボディ文字列</h4>
この場合、「マッチ文字列」は文字列または正規表現として扱われます。
レスポンスボディ内に存在する場合、置換テキストで置き換えられます。

<h3>マッチ文字列</h3>
置き換える対象を識別するために使用される文字列 - 詳細はマッチタイプを参照してください。

<h3>正規表現マッチ</h3>
設定されている場合、マッチ文字列は正規表現として扱われます。
このオプションは、実際のヘッダーと照合する場合は無効になります。
16進数バイトは「\x00 - \xFF」で表されます (例:「abc\x01\x02\x03def」)。

<h3>置換文字列</h3>
<p>
マッチした部分を置き換える新しい文字列。
16進数表記：16進数バイトは「\x00 - \xFF」で表されます。
リテラル文字列「\x00」を使用する場合は「\\x00」とエスケープしてください。
</p>

<h3>有効</h3>
設定されていない場合、ルールは適用されません。

<h3>トークン処理</h3>
<p>
有効にすると、置換文字列に動的な値で置き換えられる単一のトークンを含めることができます：
</p>
<table>
	<tr>
		<th>トークン</th>
		<th>説明</th>
	</tr>
	<tr>
		<td>{{RINT|MIN|MAX}}</td>
		<td>
			<p>ランダム整数。<code>MIN</code> と <code>MAX</code> はそれぞれオプションです。</p> 
			<p><code>MIN</code> のデフォルトは <code>0</code></p>
			<p><code>MAX</code> のデフォルトは <a href="https://docs.oracle.com/javase/8/docs/api/constant-values.html#java.lang.Integer.MAX_VALUE">Integer.maxValue</a></p>
		</td>
	</tr>
	<tr>
		<td>{{UUID}}</td>
		<td><a href="https://docs.oracle.com/javase/8/docs/api/java/util/UUID.html#randomUUID--">java.util.UUID.randomUUID()</a> を使用して生成されるランダムなUUID</td>
	</tr>
	<tr>
		<td>{{TICKS}}</td>
		<td><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/System.html#currentTimeMillis--">System.currentTimeMillis()</a> を使用したUnixエポックミリ秒</td>
	</tr>
</table> 
<p>
<strong>注:</strong> このオプションは以下のマッチタイプにのみ適用されます：
<ul>
	<li>リクエストヘッダー文字列</li>
	<li>リクエストボディ文字列</li>
	<li>レスポンスヘッダー文字列</li>
	<li>レスポンスボディ文字列 </li>
</ul>

<h3>「開始元」タブ</h3>
ルールを適用する「開始元」を指定できます。 
メッセージを送受信できる各ZAPコンポーネント (スパイダー、アクティブスキャナー、プロキシなど) は個別の開始元として扱われるため、 ルールを適用するタイミングを非常に細かく制御できます。

<p>
テキストの置換タイミングと方法をさらに詳細に制御する必要がある場合は、ZAPスクリプトコンソールを使用してください。 スクリプトを使用することで、ZAPメッセージを完全に制御できます。

</body>
</html>
