<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<TITLE>
画像位置情報・プライバシースキャナー
</TITLE>
</HEAD>
<BODY>
<H1>画像位置情報・プライバシースキャナー</H1>
The following passive scan rule is included in this add-on:
<H2 id="id-10103">画像位置情報・プライバシースキャナー</H2>

<p>Passively scans for GPS location and other privacy-related exposures in images during normal security assessments of websites. Image Location and Privacy Scanner (ILS) assists in situations where end users may post profile images and possibly give away their home location, e.g. a dating site or children's chatroom.</p>
<p>More information on this topic, including a white paper based on a real-world site audit given as a presentation at the New Jersey chapter of the OWASP organization, can be found at <a href="https://www.veggiespam.com/ils/">https://www.veggiespam.com/ils/</a>.</p>    
<p>This software scans images to find the GPS information inside of Exif tags, IPTC codes, and proprietary camera tags. Then, ILS flags the findings in the ZAP Alerts list as an information message. It would be up to the auditor to determine if location exposure is truly a security risk based on context.</p>

<h2>Sample Findings</h2>
<p>Configure the web browser to proxy through ZAP and then browse to a few sample sites to see Alerts being raised:</p>

<ul>
<li>MetaData Extractor's <a href="https://github.com/drewnoakes/metadata-extractor/wiki/SampleOutput">SampleOutput page</a>
contains some good images.  <em>(Note: For some URLs, you need a <a href="https://github.com/drewnoakes/metadata-extractor-images/tree/master/jpg">GitHub session cookie</a>)</em>
<ul>
<li><a href="https://raw.githubusercontent.com/drewnoakes/metadata-extractor-images/master/jpg/Apple%20iPhone%204.jpg" rel="nofollow">iPhone 4</a>
shows GPS data.</li>
<li><a href="https://raw.githubusercontent.com/drewnoakes/metadata-extractor-images/master/jpg/FujiFilm%20FinePixS1Pro%20(1).jpg" rel="nofollow">FujiFilm FinePix S1 Pro</a>
has embedded IPTC locations and keywords.</li>
<li><a href="https://raw.githubusercontent.com/drewnoakes/metadata-extractor-images/master/jpg/Panasonic%20DMC-TZ10.jpg" rel="nofollow">Panasonic DMC-TZ10</a> shows proprietary Panasonic MakerNote tags including city, state, country along
with facial recognition information, like the name and age of the person in
the picture. ZAP screenshot is shown below.</li>
</ul>
</li>
<li>This professional photographer utilizes Exif &amp; IPTC data in many of the full-sized (non-thumbnail) photos: <a href="https://raia.com/" rel="nofollow">Raia.com</a></li>
</ul>
<p style="margin-left: 4em;"><img src="screenshot-2-zap.png" style="max-width: 700px;"></p>

<h2>Usage Notes</h2>
<ul>
    <li>Before ZAP 2.7.x, you must manually enabled image scanning with: Tools → Options → Display → "Process images in the HTTP requests/responses" for ILS to function at all.</li>
    <li>By default, ZAP hides images in the history, but ILS stills scan these images for findings.  If an alert is triggered, then the image and its alerts will appear in the Alerts tab but not in the History tab.  To show images in the history, both with alerts and without, enable with "Process images in the HTTP" as above.</li>
    <li>If you have image processing completely disabled via Tools → Options → Network → Global Exclusions → Extension - Image (née Global Exclude URL), then any passive image scanner, like ILS, will be unable to see the images and report on privacy issues - thus disuse this feature with images so ILS can function.</li>
</ul>

Latest code: <a href="https://github.com/zaproxy/zap-extensions/tree/main/addOns/imagelocationscanner">ZAP Extension "imagelocationscanner" Source</a> <br/>
Project Source Code Origin with more information: <a href="https://github.com/veggiespam/ImageLocationScanner">Veggiespam's Image Location Scanner on GitHub</a><br/>
Project Home Page: <a href="https://www.veggiespam.com/tag/ils/">Veggiespam's Image Location Scanner</a> <br/>
Keywords: Infosec, Audit, Information Exposure, Data Leakage, Vulnerability, GPS, Exif, IPTC, PII, OpSec, Privacy


<br>
Alert ID: <a href="https://www.zaproxy.org/docs/alerts/10103/">10103</a>.

</BODY>
</HTML>
